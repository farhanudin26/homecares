# --------------------------------------------------
# PHP Handler (jangan diubah)
# --------------------------------------------------
# php -- BEGIN cPanel-generated handler, do not edit
<IfModule mime_module>
  AddHandler application/x-httpd-ea-php81 .php .php8 .phtml
</IfModule>
# php -- END cPanel-generated handler, do not edit

# --------------------------------------------------
# Custom Error Pages
# --------------------------------------------------
ErrorDocument 404 /404.html

# --------------------------------------------------
# Redirect index.html / index.php ke root domain
# --------------------------------------------------
<IfModule mod_rewrite.c>
RewriteEngine On

# Redirect ke HTTPS kalau belum pakai
RewriteCond %{HTTPS} off
RewriteRule ^(.*)$ https://%{HTTP_HOST}/$1 [L,R=301]

# Redirect www ke non-www
RewriteCond %{HTTP_HOST} ^www\.homecares\.sg [NC]
RewriteRule ^(.*)$ https://homecares.sg/$1 [L,R=301]

# Hilangkan trailing slash (SEO friendly)
RewriteCond %{REQUEST_FILENAME} !-d
RewriteRule ^(.+)/$ https://homecares.sg/$1 [R=301,L]

# âœ… Redirect index.html dan index.php ke root
RewriteCond %{THE_REQUEST} /index\.(html|php) [NC]
RewriteRule ^index\.(html|php)$ https://homecares.sg/ [R=301,L]
</IfModule>


# --------------------------------------------------
# Security Headers
# --------------------------------------------------
<IfModule mod_headers.c>
  Header always append X-Frame-Options SAMEORIGIN
  Header set X-Content-Type-Options nosniff
  Header set X-XSS-Protection "1; mode=block"
  Header set Strict-Transport-Security "max-age=31536000; includeSubDomains; preload"
  Header set Referrer-Policy "strict-origin-when-cross-origin"
  Header set Permissions-Policy "geolocation=(), microphone=(), camera=()"
</IfModule>

# --------------------------------------------------
# Caching & Expires
# --------------------------------------------------
<IfModule mod_expires.c>
  ExpiresActive On
  ExpiresByType image/jpg "access plus 1 year"
  ExpiresByType image/jpeg "access plus 1 year"
  ExpiresByType image/gif "access plus 1 year"
  ExpiresByType image/png "access plus 1 year"
  ExpiresByType image/webp "access plus 1 year"
  ExpiresByType image/svg+xml "access plus 1 year"
  ExpiresByType text/css "access plus 1 month"
  ExpiresByType text/javascript "access plus 1 month"
  ExpiresByType application/javascript "access plus 1 month"
  ExpiresByType application/x-javascript "access plus 1 month"
  ExpiresByType text/html "access plus 600 seconds"
</IfModule>

<IfModule mod_headers.c>
  <FilesMatch "\.(ico|jpg|jpeg|png|gif|webp|svg|css|js)$">
    Header set Cache-Control "max-age=31536000, public"
  </FilesMatch>
  <FilesMatch "\.(html|htm)$">
    Header set Cache-Control "max-age=600, private, must-revalidate"
  </FilesMatch>
</IfModule>

# --------------------------------------------------
# Compression: GZIP / Deflate
# --------------------------------------------------
<IfModule mod_deflate.c>
  AddOutputFilterByType DEFLATE text/plain
  AddOutputFilterByType DEFLATE text/html
  AddOutputFilterByType DEFLATE text/xml
  AddOutputFilterByType DEFLATE text/css
  AddOutputFilterByType DEFLATE application/javascript
  AddOutputFilterByType DEFLATE application/x-javascript
  AddOutputFilterByType DEFLATE application/json
  AddOutputFilterByType DEFLATE application/xml
  AddOutputFilterByType DEFLATE application/rss+xml
  AddOutputFilterByType DEFLATE application/xhtml+xml

  # Remove browser bugs for older browsers
  BrowserMatch ^Mozilla/4 gzip-only-text/html
  BrowserMatch ^Mozilla/4\.0[678] no-gzip
  BrowserMatch \bMSIE !no-gzip !gzip-only-text/html
  Header append Vary User-Agent
</IfModule>

# --------------------------------------------------
# Compression: Brotli (jika server support)
# --------------------------------------------------
<IfModule mod_brotli.c>
  AddOutputFilterByType BROTLI_COMPRESS text/plain text/html text/xml text/css application/javascript application/json application/xml application/rss+xml application/xhtml+xml
</IfModule>

# --------------------------------------------------
# Minify HTML, CSS, JS di server (tanpa build tool)
# --------------------------------------------------
<IfModule mod_filter.c>
  AddOutputFilterByType DEFLATE text/html text/css application/javascript

  # HTML minify
  SetOutputFilter DEFLATE
  AddOutputFilterByType DEFLATE text/html
</IfModule>

# Optional: Remove comments & whitespaces dari HTML
<IfModule mod_substitute.c>
  Substitute "s/<!--.*?-->//ni"
  Substitute "s/>\s+</></g"
</IfModule>


# --------------------------------------------------
# SEO Friendly URL Redirect (underscore -> hyphen)
# --------------------------------------------------
Redirect 301 /deep_cleaning.html /deep-cleaning.html
Redirect 301 /nursery_room_cleaning.html /nursery-room-cleaning.html
Redirect 301 /moving_in_cleaning.html /moving-in-cleaning.html
Redirect 301 /moving_out_cleaning.html /moving-out-cleaning.html
Redirect 301 /hip_cleaning.html /hip-cleaning.html
Redirect 301 /spring_cleaning.html /spring-cleaning.html
Redirect 301 /weekly_cleaning.html /weekly-cleaning.html
Redirect 301 /steam_cleaning.html /steam-cleaning.html
Redirect 301 /career /career.html
